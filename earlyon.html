<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EarlyON Ottawa</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }
        h2 {
            margin-top: 20px;
        }
    </style>
    <!-- Include PapaParse library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>
<body>

    <h1>EarlyON Ottawa <small>Version 1.0</small></h1>

    <p>Welcome to the central repository of all the EarlyON groups in Ottawa! Finally a place where parents can see details for all the playgroups in the city. Please note that it is highly recommended to visit the source URL to ensure that the playgroup you are planning to attend is still running. Some playgroups also require registration.</p>

    <div id="csvData"></div>

    <p>The data from this table was taken from the various Ottawa EarlyON playgroups posted on the <a href="https://ottawa.ca/en/family-and-social-services/childrens-services/earlyon" target="_blank">Ottawa.ca website</a>.</p>

    <h2>Next Steps</h2>
    <ul>
        <li>Lots of data entry needed! Unfortunately, most calendars are published as PDFs so it is not possible to automate a Python script to read data off of the individual websites</li>
        <li>Add ability to filter (by date, by area, by language)</li>
        <li>Add ability to sort</li>
        <li>Ensure header is always visible even when we scroll</li>
        <li>Ensure dates that are past don't appear</li>
        <li>Get the word out! :)</li>
    </ul>

    <script>
        let originalData; // To store the original CSV data

        window.onload = function () {
            // Update the path to your CSV file
            const csvFilePath = 'https://claudielarouche.com/earlyON/data.csv';

            fetch(csvFilePath)
                .then(response => response.text())
                .then(csvData => {
                    originalData = Papa.parse(csvData, { header: true }).data;
                    renderTable(originalData);
                })
                .catch(error => {
                    console.error('Error fetching CSV file:', error);
                });
        };

        function renderTable(data) {
            const headers = Object.keys(data[0]);

            let tableHtml = '<table id="dataTable"><thead><tr>';
            headers.forEach(header => {
                tableHtml += `<th>${header}</th>`;
            });
            tableHtml += '</tr></thead><tbody>';

            data.forEach(row => {
                tableHtml += '<tr>';
                headers.forEach(header => {
                    if (header === 'URL') {
                        // Make the URL clickable as a link
                        tableHtml += `<td><a href="${row[header]}" target="_blank">URL</a></td>`;
                    } else {
                        tableHtml += `<td>${row[header]}</td>`;
                    }
                });
                tableHtml += '</tr>';
            });

            tableHtml += '</tbody></table>';

            document.getElementById('csvData').innerHTML = tableHtml;
        }
    </script>

</body>
</html>
